# Incrementing and Decrementing cart items 
In this step you will get the "+" and "-" buttons working. These buttons are generated dynamically, that is they don't exist when the page is loaded and only come into existence after we click a button!

This another place where event delegation comes into play! Our "click" event handler can look for click events that may have been generated by one of these new buttons. 

## + and - buttons
Find the "click" event listener. It should look like this: 

```JS
document.body.addEventListener('click', (e) => {
  if (e.target.matches('.add-to-cart')) {
    console.log(e.target)
    addItemToCart(e.target.dataset.id, e.target.dataset.price)
    console.log(cart)
    displayCart()
  }
})
```

Notice that it uses `e.target.match('.add-to-cart')` to match the class name "add-to-cart" which matches when one of the add to cart buttons is clicked. 

Notice the "+" button has the class name: "button-add" and the "-" has the class name "button-sub". Find this in the `displayCart()` function, or by inspecting the DOM in your browser. 

You can match these two class names. Edit the "click" event handler like this: 

```JS
document.body.addEventListener('click', (e) => {
  if (e.target.matches('.add-to-cart')) {
    console.log(e.target)
    addItemToCart(e.target.dataset.id, e.target.dataset.price)
    console.log(cart)
    displayCart()
  } else if (e.target.matches('.button-add')) {
    // increase qty by 1
  } else if (e.target.matches('.button-sub')) {
    // decrease qty by 1
  }
})
```

Now we just need to increase or decrease the qty. To add or remove an item from the cart we need to know the name of the item. When we remove an item, if that brings the qty to 0 we need to remove that item from the cart!

### Adding items 
Add a new function, this should be placed above the `displayCart()` function. 

```JS
const addToCart = (id) => {
  for (let i = 0; i < cart.length; i += 1) {
    const item = cart[i] // get the item from the cart
    // Does the name match the name of the id? 
    if (id === item.id) {
      // if so...
      item.qty += 1 // add 1 to qty
      return // exit this function early
    }
  }
}
```

The function above, loops over the items in the cart, it tries to match the `id` (parameter variable) to the `item.id` (id of an item in the cart), if it finds a match it increases the qty of that item, and exits. 

NOTE! When a function encounters a return statement the function ends immediately. In this case the loop ends early also, and doesn't continue to the end! 

Now edit the click event listener: 

```JS
document.body.addEventListener('click', (e) => {
  if (e.target.matches('.add-to-cart')) {
    console.log(e.target)
    addItemToCart(e.target.dataset.id, e.target.dataset.price)
    console.log(cart)
    displayCart()
  } else if (e.target.matches('.button-add')) {
    const name = e.target.dataset.id
    addToCart(name)
    displayCart()
  } else if (e.target.matches('.button-sub')) {
    // decrease qty by 1
  }
})
```

When adding an item you, got the name of the item, called `addToCart(name)` and included the name as a parameter, then called `displayCart()` to update the shopping cart. 

Remember, functions don't do anything unless you call them from somewhere in your code!

Also, you can see here that functions allows us to reuse code! 

In this case, the parameter `id` in the `addToCart function`: `const addToCart = (id) => { ...` allowed us to make this function more flexible! Parameters allow us to pass data into a function to give that function context to work with!

### Removing items 
Next let's remove an item from the cart. This will be very simialr to adding items. We would combine these into the same function and use a parameter to determine whether something should be added or removed. I'm to make a separate function for simplicity. 

```JS 
const removeFromCart = (id) => {
  // Loop over items in cart
  for (let i = 0; i < cart.length; i += 1 ) {
    // get an item 
    const item = cart[i]
    // Does id match the item id? 
    if (id === item.id) {
      // if so, subtract 1 from item qty
      item.qty -= 1
      
      return 
    }
  }
}
```

This almost exactly the same as the code in the `addToCart()` function. You need to add a little extra to this because, if the qty is 0 the item should removed from the cart! 

This code must appear before `return`!

```JS
const removeFromCart = (id) => {
  // Loop over items in cart
  for (let i = 0; i < cart.length; i += 1 ) {
    // get an item 
    const item = cart[i]
    // Does id match the item id? 
    if (id === item.id) {
      // if so, subtract 1 from item qty
      item.qty -= 1
      // Check if the qty is 0
      if (item.qty === 0) {
        // If so remove this item from the cart
        cart.splice(i, 1)
      }
      return 
    }
  }
}
```

Here you added an extra if statement to check the qty. If qty is 0 you removed that item from the cart with `splice()`. The `splice()` function takes two parameters, the first is the index to start removing items, and the second is the number of items to remove. 

Read more about `array.splice()`: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice

You need to do call this function and the `displayCart()` function when the button with the class name `button-sub` is clicked. Try this on your own! 

-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-

Check your work! You should find the click event and add the following, in the if else block that matches '.button-sub'. 

```JS
document.body.addEventListener('click', (e) => {
  if (e.target.matches('.add-to-cart')) {
    addItemToCart(e.target.dataset.id, e.target.dataset.price)
    displayCart()
  } else if (e.target.matches('.button-add')) {
    const name = e.target.dataset.id
    addToCart(name)
    displayCart()
  } else if (e.target.matches('.button-sub')) {
    // New Code here! 
    const name = e.target.dataset.id // get the id
    removeFromCart(name) // call remove cart
    displayCart() // display the cart
  }
})
```

### Test your work! 
Follow the same steps you did with the last step. Think about what your are doing with each step, before it happens, predict the results, see what happens and compare if that matches your expectations. 

- Load the page with live server - You should see the list of products
- Click one of the add to cart buttons - You should a cart item appear at the bottom of the page. 
  - The qty should be 1
  - The name and price should appear
  - The total price should equal the qty times the price
- click another item - that item should appear in the cart.
- Click the add to cart button for an item that already exists in the cart - the qty for that item should increase by 1
  - Note the totla price, it should increase and be equal to qty * price
- Click the "+" next to a cart item - the qty for that item should increase by 1
- Click the "-" button next to a cart item - the qty for that item shoudl decrease by 1, the total price should update. 
- Click the "-" until the qty of the item gets to 0 - the item should be removed from the cart.

If your page is not functioning, watch closely and ask yourself what is going wrong, this will be connected to one of the actions. It might not load, or it might not update an item when your click. Think about the code tied to that action. Check the console for error messages, look for the file name and line number of the error. 

## What happens here? 
Lets 

- The page loads
- data is imported from data.json
- the for loop creates the inventory generating divs, and img tags etc. 
- cart is defined as an empty array []
- all of the functions are defined. 
- the click event listener is created

At this stage we can see the page, and it is waiting for us to interact. When we click the add to cart button:

- A click event occurs at the button. That click event "bubbles" up to the body element where it is processed. 
  - The click event handler looks at the event targt, and tries to match it. 
  - If the target matches class name "add-to-cart" your code gets the name and price from the data attributes and calls the `addToCart()` function with these values
    - `addToCart()` creates a new cart item object and adds that to the cart array. 
    - The calls `displayCart()` to update the shopping cart.
  - If the target matches the class name "button-add"
    - You get the data id of the item
    - Call the `addToCart()` with the id
      - The `addToCart()` method receives the id
      - Loops over all items in the cart
      - matches the id it received to id of each item
      - if it finds a match it increments the qty
      - and returns 
    - Call `displayCart()` to update the cart displayed. 
  - If the target matches the class name "button-sub"
    - You get the data id of the item
    - Call the `removeFromCart()` with the id
      - The `removeFromCart()` method receives the id
      - Loops over all items in the cart
      - matches the id it received to id of each item
      - if it finds a match it decrements the qty
      - If the qty is 0
        - It removes the item at index i from the cart array
      - and returns 
    - Call `displayCart()` to update the cart displayed. 
    
## Conclusion 
In this section you added some functionality to the shopping cart system. You used:
- You defined two new functions `addToCart()` and `removeFromCart()`
- You used parameters to make those functions more useful. `addToCart(id)` and `removeFromCart(id)`
- A for loop to loop over the items of an array
- You expanded your event delegation to include two new buttons with different functionality.
- You used `splice()` to remove an item from an array.

# Update progress on Github
> [action]
>
> Now is a good time to update your progress on Github.
>
```bash
git add .
git commit -m 'added removeItem function'
git push
```
